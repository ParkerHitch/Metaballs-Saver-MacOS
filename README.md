# MacOS Metaballs Screensaver
A custom MacOS screen saver, featuring 2D metaball outlines that merge with each other and with the current time, all rendered on the GPU using Metal!

### Preview:

[image](https://github.com/ParkerHitch/Metaballs-Saver-MacOS/assets/38385291/12ebe05b-0841-4087-938d-aec4e88338e1)

*NOTE: For some reason the screen recording messes with the colors. Trust me, they look normal when you actually run it. (The lines are also a lot thicker.)*

### How it works:
The project uses 3 main tools:

1. The first is the nightmare that is Apple's whole proprietary way to make applications in Objective C. The core of this is a class called ScreenSaverView, whose methods are overridden to run the core application code, such as setting up render pipelines.
2. Next is FreeType. [FreeType](https://freetype.org/) is an amazing and open way to render text from ttf files to bitmaps or vectors. In this case, it is used to calculate a [distance field](https://steamcdn-a.akamaihd.net/apps/valve/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf) for each character in the time, every minute, and then write them to a texture to be used in the render pipeline.
3. Finally, we come to the inspiration for this project: shader code in Metal! There are 3 distinct vertex & fragment shader pairs that run each frame to render the text. The first takes the location and size of each ball and writes the sum of the distances to each pixel on a texture. The second performs marching squares on the ball distance texture and the sdf generated by freetype to combine them and save an outline to a texture. The final pass performs some anti-aliasing and adds color to the output of the previous pass, drawing the result to the screen.

### To install:
Just download and build the project, then double-click the .saver file produced. Make sure that you have freetype installed via `brew install freetype`. To change the font, edit `FONTNAME` in `timeGen.m`. 
You may also have to change the face_index in [FT_New_Face](https://freetype.org/freetype2/docs/reference/ft2-face_creation.html#ft_new_face) (line 37). Currently working on a preference panel to be able to actually select fonts!
